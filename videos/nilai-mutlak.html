<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Pembelajaran UMT</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #141414;
            color: #ffffff;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background: rgba(42, 42, 42, 0.9);
            backdrop-filter: blur(10px);
            padding: 20px 25px;
            margin-bottom: 30px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative; /* Tambahkan ini jika belum ada */
            z-index: 100; /* Tambahkan ini */
        }
        
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            font-size: 14px;
            color: #cccccc;
            flex-wrap: wrap;
        }
        
        .breadcrumb a {
            color: #888;
            text-decoration: none;
            transition: color 0.3s ease;
            padding: 5px 8px;
            border-radius: 5px;
        }
        
        .breadcrumb-separator {
            color: #666;
            font-weight: bold;
        }
        
        .dropdown-container {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-trigger {
            background: rgba(42, 42, 42, 0.9);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        #currentClass {
            font-weight: 500px;
        }
        
        .dropdown-arrow {
            transition: transform 0.3s ease;
        }
        
        .dropdown-arrow.open {
            transform: rotate(180deg);
        }
        
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            min-width: 200px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 9999;
        }
        
        .dropdown-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-item {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            color: #cccccc;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 14px;
            cursor: pointer;
        }
        
        .dropdown-item:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
        }
        
        .dropdown-item.active {
            color: white;
        }
        
        .page-title {
            font-size: 2.2rem;
            font-weight: bold;
            background: white;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .content-wrapper {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .video-section {
            background: rgba(42, 42, 42, 0.9);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1;
        }
        
        .video-player {
            position: relative;
            aspect-ratio: 16/9;
            background: #000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }
        
        .youtube-embed {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .video-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 18px;
        }
        
        .video-info {
            padding: 25px;
        }
        
        .video-title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ffffff;
        }
        
        .video-meta {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #cccccc;
            flex-wrap: wrap;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .video-description {
            line-height: 1.6;
            color: #e0e0e0;
            margin-bottom: 20px;
        }
        
        .video-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tag {
            background: linear-gradient(135deg, #4285f4, #5aa3f5);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
            min-width: 150px;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-primary {
            background: #32CD32;
            color: white;
            box-shadow: 0 5px 15px rgba(50, 205, 50, 0.4);
        }
        
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 107, 53, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #4285f4, #5aa3f5);
            color: white;
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.3);
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(66, 133, 244, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745, #34ce57);
            color: white;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }
        
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .progress-card, .related-videos {
            background: rgba(42, 42, 42, 0.9);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }
        
        .card-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: #ffffff;
        }
        
        .progress-bar {
            background: rgba(255, 255, 255, 0.1);
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .progress-fill {
            background: #32CD32;
            height: 100%;
            border-radius: 6px;
            position: relative;
            transition: width 0.5s ease;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .progress-text {
            color: #cccccc;
            font-size: 14px;
        }
        
        .video-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .video-item {
            display: flex;
            gap: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        
        .video-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .video-item.completed {
            border-color: rgba(40, 167, 69, 0.5);
            background: rgba(40, 167, 69, 0.1);
        }
        
        .video-item.current {
            border-color: #888;
            background: #888;
        }
        
        .video-thumb {
            width: 80px;
            height: 60px;
            background: linear-gradient(135deg, #555, #777);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            position: relative;
        }
        
        .video-thumb::after {
            content: '▶';
            color: #333333;
            font-size: 18px;
        }
        
        .video-thumb.completed::after {
            content: '✓';
            color: #28a745;
            font-size: 20px;
            font-weight: bold;
        }
        
        .video-details {
            flex: 1;
        }
        
        .video-details h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
            color: #ffffff;
        }
        
        .video-details p {
            font-size: 12px;
            color: #aaaaaa;
        }
        
        .auto-play-notice {
            background: rgba(66, 133, 244, 0.1);
            border: 1px solid rgba(66, 133, 244, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
            color: #4285f4;
            font-size: 14px;
        }
        
        @media (max-width: 1024px) {
            .content-wrapper {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .sidebar {
                order: -1;
            }
            
            .progress-card, .related-videos {
                padding: 20px;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 15px 20px;
            }
            
            .page-title {
                font-size: 1.8rem;
            }
            
            .video-info {
                padding: 20px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                min-width: auto;
            }
            
            .breadcrumb {
                font-size: 12px;
            }
            
            .dropdown-trigger {
                font-size: 12px;
                padding: 4px 8px;
            }
        }
        
        @media (max-width: 480px) {
            .video-meta {
                flex-direction: column;
                gap: 10px;
            }
            
            .video-item {
                flex-direction: column;
                text-align: center;
            }
            
            .video-thumb {
                width: 100%;
                height: 160px;
            }
        }
        .btn-quiz {
            background: linear-gradient(135deg, #ff6b35, #ff8c5a);
            color: white;
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }
        
        .btn-quiz:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 107, 53, 0.4);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="breadcrumb">
                <a href="https://www.umt6174.site/" onclick="goHome()" target="_blank">Home</a>
                <span class="breadcrumb-separator">></span>
                <a href="https://sites.google.com/view/videopembelajaranumt/video-pembelajaran-umt" onclick="goToVideoList()" target="_blank">Video Pembelajaran</a>
                <span class="breadcrumb-separator">></span>
                <div class="dropdown-container">
                    <div class="dropdown-trigger" onclick="toggleDropdown()">
                        <span id="currentClass">Kelas Nilai Mutlak</span>
                        <span class="dropdown-arrow">▼</span>
                    </div>
                    <div class="dropdown-menu" id="classDropdown">
                        <a href="https://sites.google.com/view/limit-umt/limit" class="dropdown-item" target="_blank">Limit</a>
                        <a href="https://sites.google.com/view/trigonometri-umt/trigonometri" class="dropdown-item" target="_blank">Trigonometri</a>
                        <a href="https://sites.google.com/view/bentuk-akar-umt/video-pembelajaran" class="dropdown-item" target="_blank">Bentuk Akar</a>
                        <a href="https://sites.google.com/view/nilai-mutlak-umt/nilai-mutlak" class="dropdown-item active" target="_blank">Nilai Mutlak</a>
                    </div>
                </div>
            </div>
            <h1 class="page-title" id="pageTitle">Limit</h1>
        </div>
        
        <div class="content-wrapper">
            <div class="video-section">
                <div class="video-player" id="videoPlayer">
                    <div class="video-loading">Klik video di sidebar untuk memulai</div>
                    <div class="video-controls">
                        <button class="fullscreen-btn" onclick="toggleFullscreen()" id="fullscreenToggle" style="display: none;">
                            ⛶ Fullscreen
                        </button>
                    </div>
                </div>

<!-- Fullscreen container -->
                <div class="fullscreen-container" id="fullscreenContainer">
                    <div class="fullscreen-controls">
                        <button class="fullscreen-btn" onclick="exitFullscreen()">
                            ✕ Keluar Fullscreen
                        </button>
                    </div>
                </div>
                
                <div class="video-info">
                    <h2 class="video-title" id="videoTitle">Pilih video untuk memulai pembelajaran</h2>
                    
                    <div class="video-meta" id="videoMeta">
                        <div class="meta-item">
                            <span>⏱️</span>
                            <span id="videoDuration">--:--</span>
                        </div>
                        <div class="meta-item">
                            <span>👁️</span>
                            <span id="videoViews">-- views</span>
                        </div>
                        <div class="meta-item">
                            <span>📅</span>
                            <span id="videoDate">--</span>
                        </div>
                    </div>
                    
                    <div class="video-description" id="videoDescription">
                        Pilih video dari daftar di sebelah kanan untuk memulai pembelajaran. 
                        Setiap video dilengkapi dengan materi pembelajaran yang komprehensif dan mudah dipahami.
                    </div>
                    
                    <div class="video-tags" id="videoTags">
                        <span class="tag">Matematika</span>
                        <span class="tag">Kelas X</span>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="completeBtn" onclick="markAsComplete()" disabled>
                            ✓ Tandai Selesai
                        </button>
                        <a href="#" class="btn btn-secondary" id="downloadBtn" onclick="downloadNotes()">
                            📝 Unduh Catatan
                        </a>
                        <a href="#" class="btn btn-quiz" id="quizBtn" onclick="goToQuiz()" target="_blank">
                            🎯 Uji Kemampuan
                        </a>
                    </div>
                    
                    <div class="auto-play-notice" id="autoPlayNotice" style="display: none;">
                        Video selanjutnya akan dimulai dalam <span id="countdown">5</span> detik...
                        <button onclick="cancelAutoPlay()" style="margin-left: 10px; background: none; border: 1px solid #4285f4; color: #4285f4; padding: 5px 10px; border-radius: 5px; cursor: pointer;">Batal</button>
                    </div>
                </div>
            </div>
            
            <div class="sidebar">
                <div class="progress-card">
                    <h3 class="card-title">Progress Pembelajaran</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <p class="progress-text" id="progressText">0 dari 5 video selesai (0%)</p>
                </div>
                
                <div class="related-videos">
                    <h3 class="card-title">Daftar Video</h3>
                    <div class="video-list" id="videoList">
                        <!-- Video list akan diisi oleh JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
// Data video pembelajaran
const videoData = {
    'matematika-10': [
        {
            id: 'limit-dasar',
            title: 'Nilai Mutlak - Definisi',
            youtubeId: 'zwth9824dhU?si=l-AjS2KOJZRx74Rs',
            duration: '00:53',
            description: 'Video ini membahas pemahaman dasar tentang definisi limit. Materi disajikan untuk membangun pemahaman yang kuat tentang nilai mutlak secara konseptual dan visual.',
            tags: ['Matematika', 'Nilai Mutlak', 'Dasar'],
            pdfUrl: '/notes/limit-dasar.pdf',
            completed: false,
            thumbnail:'Thumb Definisi Nilai Mutlak.png',
            quizUrl: 'https://forms.gle/o7RuibY5TTRbFur99',
        },
        {
            id: 'limit-dasar',
            title: 'Nilai Mutlak - Representasi Geometri',
            youtubeId: 'MxhGHR0zuuo?si=1WJ8LiXWZfesvzEH',
            duration: '03:32',
            description: 'Video ini membahas pemahaman dasar tentang representasi geometri dari nilai mutlak. Materi disajikan untuk membangun pemahaman yang kuat tentang nilai mutlak secara konseptual dan visual.',
            tags: ['Matematika', 'Nilai Mutlak', 'Dasar'],
            pdfUrl: '/notes/limit-dasar.pdf',
            completed: false,
            thumbnail:'Thumb Representasi Geometri Dari Nilai Mutlak.png',
            quizUrl: 'https://forms.gle/AuWMFTjCp6xMYpgF9',
        },
        {
            id: 'limit-dasar',
            title: 'Nilai Mutlak - Sifat - Sifat Dasar',
            youtubeId: 'CVrjAQdhFFg?si=KQcOiD1yznc-jbqt',
            duration: '01:26',
            description: 'Video ini membahas pemahaman dasar tentang sifat sifat dasar nilai mutlak. Materi disajikan untuk membangun pemahaman yang kuat tentang nilai mutlak secara konseptual dan visual.',
            tags: ['Matematika', 'Nilai Mutlak', 'Dasar'],
            pdfUrl: '/notes/limit-dasar.pdf',
            completed: false,
            thumbnail:'sifat dasar nilai mutlak.png',
            quizUrl: 'https://forms.gle/oCv3anCAakv31E9w8',
        }
    ]
};

let currentCourse = 'matematika-10';
let currentVideoIndex = -1;
let autoPlayTimer = null;
let isFullscreen = false;

// Fungsi untuk menyimpan progress ke localStorage
function saveProgress() {
    try {
        const progressData = {
            courseProgress: videoData,
            currentCourse: currentCourse,
            currentVideoIndex: currentVideoIndex,
            lastUpdated: new Date().toISOString()
        };
        localStorage.setItem('umt_video_progress', JSON.stringify(progressData));
        console.log('Progress saved successfully');
    } catch (error) {
        console.error('Error saving progress:', error);
    }
}

// Fungsi untuk memuat progress dari localStorage
function loadProgress() {
    try {
        const saved = localStorage.getItem('umt_video_progress');
        if (saved) {
            const progressData = JSON.parse(saved);
            
            // Merge saved data dengan videoData saat ini
            Object.keys(progressData.courseProgress).forEach(courseKey => {
                if (videoData[courseKey]) {
                    videoData[courseKey].forEach((video, index) => {
                        if (progressData.courseProgress[courseKey] && 
                            progressData.courseProgress[courseKey][index]) {
                            video.completed = progressData.courseProgress[courseKey][index].completed || false;
                        }
                    });
                }
            });
            
            // Restore current course jika ada
            if (progressData.currentCourse && videoData[progressData.currentCourse]) {
                currentCourse = progressData.currentCourse;
            }
            
            console.log('Progress loaded successfully');
            return true;
        }
    } catch (error) {
        console.error('Error loading progress:', error);
    }
    return false;
}

// Inisialisasi halaman
function initializePage() {
    // Load saved progress terlebih dahulu
    loadProgress();
    
    renderVideoList();
    updateProgress();
    resetVideoPlayer();

    document.addEventListener('fullscreenchange', handleFullscreenChange);
    document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
    document.addEventListener('mozfullscreenchange', handleFullscreenChange);
    document.addEventListener('MSFullscreenChange', handleFullscreenChange);
}

function handleFullscreenChange() {
    isFullscreen = !!(document.fullscreenElement || 
                     document.webkitFullscreenElement || 
                     document.mozFullScreenElement || 
                     document.msFullscreenElement);
    
    const videoContainer = document.getElementById('videoPlayer');
    const fullscreenBtn = document.getElementById('fullscreenBtn');
    
    if (isFullscreen) {
        videoContainer.classList.add('fullscreen-active');
        if (fullscreenBtn) fullscreenBtn.innerHTML = '⊡ Exit Fullscreen';
    } else {
        videoContainer.classList.remove('fullscreen-active');
        if (fullscreenBtn) fullscreenBtn.innerHTML = '⛶ Fullscreen';
    }
}

function toggleFullscreen() {
    const videoContainer = document.getElementById('videoPlayer');
    
    if (!isFullscreen) {
        // Enter fullscreen
        if (videoContainer.requestFullscreen) {
            videoContainer.requestFullscreen();
        } else if (videoContainer.webkitRequestFullscreen) {
            videoContainer.webkitRequestFullscreen();
        } else if (videoContainer.mozRequestFullScreen) {
            videoContainer.mozRequestFullScreen();
        } else if (videoContainer.msRequestFullscreen) {
            videoContainer.msRequestFullscreen();
        }
    } else {
        // Exit fullscreen
        if (document.exitFullscreen) {
            document.exitFullscreen();
        } else if (document.webkitExitFullscreen) {
            document.webkitExitFullscreen();
        } else if (document.mozCancelFullScreen) {
            document.mozCancelFullScreen();
        } else if (document.msExitFullscreen) {
            document.msExitFullscreen();
        }
    }
}

// Render daftar video
function renderVideoList() {
    const videoListContainer = document.getElementById('videoList');
    const videos = videoData[currentCourse] || [];
    
    videoListContainer.innerHTML = videos.map((video, index) => `
        <div class="video-item ${video.completed ? 'completed' : ''} ${index === currentVideoIndex ? 'current' : ''}" 
             onclick="selectVideo(${index})">
            <div class="video-thumb ${video.completed ? 'completed' : ''}" style="background-image: url('${video.thumbnail || ''}'); background-size: cover; background-position: center;">
                ${video.completed ? '' : '<div class="play-overlay">▶</div>'}
            </div>
            <div class="video-details">
                <h4>${video.title}</h4>
                <p>${video.duration} • Tim UMT</p>
            </div>
        </div>
    `).join('');
}

// Pilih video
function selectVideo(index) {
    const videos = videoData[currentCourse] || [];
    if (index >= 0 && index < videos.length) {
        currentVideoIndex = index;
        const video = videos[index];
        
        loadVideo(video);
        updateVideoInfo(video);
        renderVideoList();
        
        // Enable complete button jika video belum selesai
        const completeBtn = document.getElementById('completeBtn');
        if (video.completed) {
            completeBtn.textContent = '✓ Selesai';
            completeBtn.className = 'btn btn-success';
            completeBtn.disabled = true;
        } else {
            completeBtn.textContent = '✓ Tandai Selesai';
            completeBtn.className = 'btn btn-primary';
            completeBtn.disabled = false;
        }
        
        // Simpan state saat ini
        saveProgress();
    }
}

// Load video YouTube
async function loadVideo(video) {
    const videoPlayer = document.getElementById('videoPlayer');
    const embedUrl = `https://www.youtube.com/embed/${video.youtubeId}?autoplay=1&rel=0&modestbranding=1&showinfo=0&enablejsapi=1`;
    
    // Show loading
    videoPlayer.innerHTML = '<div class="video-loading">Memuat video...</div>';
    
    // Load video
    setTimeout(() => {
        videoPlayer.innerHTML = `
            <div class="video-wrapper" style="position: relative; width: 100%; height: 100%;">
                <iframe class="youtube-embed" 
                        src="${embedUrl}" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" 
                        allowfullscreen
                        webkitallowfullscreen
                        mozallowfullscreen
                        id="currentVideo"
                        style="width: 100%; height: 100%; border: none;">
                </iframe>
                <div class="video-controls" style="
                    position: absolute;
                    top: 10px;
                    right: 10px;
                    z-index: 1000;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                ">
                    <button id="fullscreenBtn" onclick="toggleFullscreen()" style="
                        background: rgba(0, 0, 0, 0.7);
                        color: white;
                        border: none;
                        padding: 8px 12px;
                        border-radius: 20px;
                        cursor: pointer;
                        font-size: 12px;
                        backdrop-filter: blur(10px);
                        transition: all 0.3s ease;
                    " onmouseover="this.style.background='rgba(0, 0, 0, 0.9)'" 
                       onmouseout="this.style.background='rgba(0, 0, 0, 0.7)'">
                        ⛶ Fullscreen
                    </button>
                </div>
            </div>
        `;
        
        // Show controls on hover
        const videoWrapper = videoPlayer.querySelector('.video-wrapper');
        const controls = videoPlayer.querySelector('.video-controls');
        
        videoWrapper.addEventListener('mouseenter', () => {
            controls.style.opacity = '1';
        });
        
        videoWrapper.addEventListener('mouseleave', () => {
            controls.style.opacity = '0';
        });
        
    }, 500);
    
    // Load video stats
    const stats = await getVideoStats(video.youtubeId);
    document.getElementById('videoViews').textContent = stats.views;
    document.getElementById('videoDate').textContent = stats.date;
}

// Update informasi video
function updateVideoInfo(video) {
    document.getElementById('pageTitle').textContent = video.title;
    document.getElementById('videoTitle').textContent = video.title;
    document.getElementById('videoDuration').textContent = video.duration;
    document.getElementById('videoDescription').textContent = video.description;
    
    // Update tags
    const tagsContainer = document.getElementById('videoTags');
    tagsContainer.innerHTML = video.tags.map(tag => `<span class="tag">${tag}</span>`).join('');
    
    // Update download link
    const downloadBtn = document.getElementById('downloadBtn');
    downloadBtn.href = `https://drive.google.com/file/d/1BX_example_${video.id}/view?usp=sharing`;
    downloadBtn.target = '_blank';
}

// Tandai video selesai
function markAsComplete() {
    const videos = videoData[currentCourse] || [];
    if (currentVideoIndex >= 0 && currentVideoIndex < videos.length) {
        const video = videos[currentVideoIndex];
        
        if (video.completed) return;
        
        video.completed = true;
        
        // Update UI dengan animasi
        const btn = document.getElementById('completeBtn');
        btn.style.transform = 'scale(0.95)';
        btn.textContent = '✓ Menandai...';
        
        setTimeout(() => {
            btn.textContent = '✓ Selesai';
            btn.className = 'btn btn-success';
            btn.disabled = true;
            btn.style.transform = 'scale(1)';
            
            // Update progress dan video list
            renderVideoList();
            updateProgress();
            
            // Simpan progress setelah menandai selesai
            saveProgress();
            
            // Show completion notification
            showCompletionNotification(video.title);
            
            // Auto play next video setelah delay
            setTimeout(() => {
                playNextVideo();
            }, 2000);
        }, 500);
    }
}

// Putar video selanjutnya
function playNextVideo() {
    const videos = videoData[currentCourse] || [];
    const nextIndex = currentVideoIndex + 1;
    
    if (nextIndex < videos.length) {
        const nextVideo = videos[nextIndex];
        showAutoPlayNotice(nextVideo.title);
        
        let countdown = 5;
        const countdownElement = document.getElementById('countdown');
        
        autoPlayTimer = setInterval(() => {
            countdown--;
            countdownElement.textContent = countdown;
            
            if (countdown <= 0) {
                clearInterval(autoPlayTimer);
                hideAutoPlayNotice();
                selectVideo(nextIndex);
            }
        }, 1000);
    } else {
        // Semua video selesai
        showCourseCompletionNotification();
    }
}

// Tampilkan notifikasi auto play
function showAutoPlayNotice(nextVideoTitle) {
    const notice = document.getElementById('autoPlayNotice');
    notice.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 10px;">
            <div>
                <div style="font-weight: bold; margin-bottom: 5px;">Video Selanjutnya:</div>
                <div style="font-size: 13px; opacity: 0.8;">${nextVideoTitle}</div>
                <div style="margin-top: 5px;">Dimulai dalam <span id="countdown">5</span> detik...</div>
            </div>
            <button onclick="cancelAutoPlay()" style="
                background: none; 
                border: 1px solid #4285f4; 
                color: #4285f4; 
                padding: 8px 15px; 
                border-radius: 20px; 
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 12px;
            " onmouseover="this.style.background='rgba(66, 133, 244, 0.1)'" onmouseout="this.style.background='none'">
                Batal
            </button>
        </div>
    `;
    notice.style.display = 'block';
}

// Sembunyikan notifikasi auto play
function hideAutoPlayNotice() {
    document.getElementById('autoPlayNotice').style.display = 'none';
}

// Batalkan auto play
function cancelAutoPlay() {
    if (autoPlayTimer) {
        clearInterval(autoPlayTimer);
        autoPlayTimer = null;
    }
    hideAutoPlayNotice();
}

// Update progress
function updateProgress() {
    const videos = videoData[currentCourse] || [];
    const completedVideos = videos.filter(video => video.completed).length;
    const totalVideos = videos.length;
    const percentage = totalVideos > 0 ? Math.round((completedVideos / totalVideos) * 100) : 0;
    
    // Animate progress bar
    const progressFill = document.getElementById('progressFill');
    progressFill.style.transition = 'width 0.8s ease';
    progressFill.style.width = percentage + '%';
    
    document.getElementById('progressText').textContent = 
        `${completedVideos} dari ${totalVideos} video selesai (${percentage}%)`;
}

// Download catatan
function downloadNotes() {
    const videos = videoData[currentCourse] || [];
    if (currentVideoIndex >= 0 && currentVideoIndex < videos.length) {
        const video = videos[currentVideoIndex];
        
        // Show download notification
        const notification = document.createElement('div');
        notification.innerHTML = `
            <div style="
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #4285f4, #5aa3f5);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 5px 20px rgba(66, 133, 244, 0.3);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            ">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span>📝</span>
                    <div>Mengunduh catatan...</div>
                </div>
            </div>
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            document.body.removeChild(notification);
        }, 2000);
        
        console.log('Downloading notes for:', video.title);
    }
}

function goToQuiz() {
   const videos = videoData[currentCourse] || [];
   if (currentVideoIndex >= 0 && currentVideoIndex < videos.length) {
       const video = videos[currentVideoIndex];
       if (video.quizUrl && video.quizUrl !== '#') {
           window.open(video.quizUrl, '_blank');
       } else {
           alert('Quiz untuk video ini belum tersedia.');
       }
   }
}

// Dropdown functions
function toggleDropdown() {
    const dropdown = document.getElementById('classDropdown');
    const arrow = document.querySelector('.dropdown-arrow');
    
    dropdown.classList.toggle('show');
    arrow.classList.toggle('open');
}

function selectClass(grade, subject) {
    let courseKey = '';
    let classText = '';
    
    // Mapping grade dan subject ke courseKey yang sesuai
    if (grade === '10' && subject === 'Matematika') {
        courseKey = 'matematika-10';
        classText = 'Kelas Limit';
    } else if (grade === '10' && subject === 'Fisika') {
        courseKey = 'fisika-10';
        classText = 'Kelas Aljabar';
    } else if (grade === '10' && subject === 'Kimia') {
        courseKey = 'kimia-10';
        classText = 'Kelas Trigonometri';
    } else if (grade === '11' && subject === 'Matematika') {
        courseKey = 'matematika-11';
        classText = 'Kelas Nilai Mutlak';
    }
    
    // Update current course
    if (videoData[courseKey]) {
        currentCourse = courseKey;
        currentVideoIndex = -1; // Reset video selection
        
        document.getElementById('currentClass').textContent = classText;
        
        // Update active state
        document.querySelectorAll('.dropdown-item').forEach(item => {
            item.classList.remove('active');
        });
        event.target.classList.add('active');
        
        // Close dropdown
        document.getElementById('classDropdown').classList.remove('show');
        document.querySelector('.dropdown-arrow').classList.remove('open');
        
        // Refresh UI
        renderVideoList();
        updateProgress();
        resetVideoPlayer();
        
        // Simpan perubahan course
        saveProgress();
    }
}

function resetVideoPlayer() {
    const videoPlayer = document.getElementById('videoPlayer');
    videoPlayer.innerHTML = '<div class="video-loading">Klik video di sidebar untuk memulai</div>';
    
    // Reset video info
    document.getElementById('pageTitle').textContent = 'Pilih Video Pembelajaran';
    document.getElementById('videoTitle').textContent = 'Pilih video untuk memulai pembelajaran';
    document.getElementById('videoDuration').textContent = '--:--';
    document.getElementById('videoViews').textContent = '-- views';
    document.getElementById('videoDate').textContent = '--';
    document.getElementById('videoDescription').textContent = 
        'Pilih video dari daftar di sebelah kanan untuk memulai pembelajaran. Setiap video dilengkapi dengan materi pembelajaran yang komprehensif dan mudah dipahami.';
    
    // Reset buttons
    const completeBtn = document.getElementById('completeBtn');
    completeBtn.textContent = '✓ Tandai Selesai';
    completeBtn.className = 'btn btn-primary';
    completeBtn.disabled = true;
    
    hideAutoPlayNotice();
}

// Navigation functions
function goHome() {
    window.location.href = 'https://www.umt6174.site/';
}

function goToVideoList() {
    // Implementasi navigasi ke daftar video
    console.log('Navigate to video list');
}

// YouTube API integration untuk video stats
async function getVideoStats(videoId) {
    try {
        // Simulasi data karena YouTube API memerlukan API key
        const stats = {
            views: Math.floor(Math.random() * 10000) + 1000,
            publishedAt: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000)
        };
        
        return {
            views: formatViews(stats.views),
            date: formatDate(stats.publishedAt)
        };
    } catch (error) {
        console.log('Error fetching video stats:', error);
        return {
            views: '1,247 views',
            date: '2 hari lalu'
        };
    }
}

// Format views count
function formatViews(views) {
    if (views >= 1000000) {
        return Math.floor(views / 1000000) + 'M views';
    } else if (views >= 1000) {
        return Math.floor(views / 1000) + 'K views';
    }
    return views + ' views';
}

// Format date
function formatDate(date) {
    const now = new Date();
    const diffTime = Math.abs(now - date);
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    
    if (diffDays === 1) return '1 hari lalu';
    if (diffDays < 7) return `${diffDays} hari lalu`;
    if (diffDays < 30) return `${Math.floor(diffDays / 7)} minggu lalu`;
    return `${Math.floor(diffDays / 30)} bulan lalu`;
}

// Show completion notification
function showCompletionNotification(videoTitle) {
    const notification = document.createElement('div');
    notification.className = 'completion-notification';
    notification.innerHTML = `
        <div style="
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #28a745, #34ce57);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(40, 167, 69, 0.3);
            z-index: 10000;
            animation: slideIn 0.3s ease;
            max-width: 300px;
        ">
            <div style="display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 20px;">🎉</span>
                <div>
                    <div style="font-weight: bold; margin-bottom: 5px;">Video Selesai!</div>
                    <div style="font-size: 14px; opacity: 0.9;">${videoTitle}</div>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(notification);
    
    // Remove notification setelah 3 detik
    setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => {
            if (document.body.contains(notification)) {
                document.body.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

// Show course completion
function showCourseCompletionNotification() {
    const notification = document.createElement('div');
    notification.className = 'course-completion-modal';
    notification.innerHTML = `
        <div class="course-completion-modal">
            <div class="completion-icon">🎓</div>
            <h3>Selamat!</h3>
            <p>Anda telah menyelesaikan semua video dalam kursus ini!</p>
            <button onclick="this.parentElement.parentElement.remove()">
                Tutup
            </button>
        </div>
    `;
    
    document.body.appendChild(notification);
}

// Fungsi reset progress (untuk debugging/testing)
function resetProgress() {
    if (confirm('Apakah Anda yakin ingin menghapus semua progress pembelajaran?')) {
        localStorage.removeItem('umt_video_progress');
        location.reload();
    }
}

// Close dropdown ketika klik di luar
document.addEventListener('click', function(event) {
    const dropdown = document.querySelector('.dropdown-container');
    if (!dropdown.contains(event.target)) {
        document.getElementById('classDropdown').classList.remove('show');
        document.querySelector('.dropdown-arrow').classList.remove('open');
    }
});


// Add CSS animations
const style = document.createElement('style');
style.textContent = `
    @keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    
    @keyframes slideOut {
        from {
            transform: translateX(0);
            opacity: 1;
        }
        to {
            transform: translateX(100%);
            opacity: 0;
        }
    }
    
    /* Fullscreen styles */
    #videoPlayer.fullscreen-active {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        z-index: 999999 !important;
        background: black !important;
    }
    
    #videoPlayer.fullscreen-active .video-wrapper {
        width: 100% !important;
        height: 100% !important;
    }
    
    #videoPlayer.fullscreen-active .youtube-embed {
        width: 100% !important;
        height: 100% !important;
    }
    
    .video-controls {
        transition: opacity 0.3s ease !important;
    }
    
    .video-wrapper:hover .video-controls {
        opacity: 1 !important;
`;
document.head.appendChild(style);

// Initialize page ketika DOM loaded
document.addEventListener('DOMContentLoaded', function() {
    initializePage();
    
    // Load first video automatically jika tersedia
    const videos = videoData[currentCourse] || [];
    if (videos.length > 0) {
        console.log('Ready to start learning with', videos.length, 'videos');
    }
});

// Handle keyboard shortcuts
document.addEventListener('keydown', function(event) {
    // F untuk fullscreen toggle
    if (event.code === 'KeyF' && currentVideoIndex >= 0) {
        event.preventDefault();
        toggleFullscreen();
    }
    
    // Escape untuk exit fullscreen
    if (event.code === 'Escape' && isFullscreen) {
        event.preventDefault();
        toggleFullscreen();
    }
    
    // Space atau Enter untuk mark complete
    if ((event.code === 'Space' || event.code === 'Enter') && currentVideoIndex >= 0) {
        const completeBtn = document.getElementById('completeBtn');
        if (!completeBtn.disabled && !isFullscreen) {
            event.preventDefault();
            markAsComplete();
        }
    }
    
    // Arrow keys untuk navigasi (hanya jika tidak fullscreen)
    if (!isFullscreen) {
        if (event.code === 'ArrowDown' || event.code === 'ArrowRight') {
            event.preventDefault();
            const videos = videoData[currentCourse] || [];
            const nextIndex = currentVideoIndex + 1;
            if (nextIndex < videos.length) {
                selectVideo(nextIndex);
            }
        }
        
        if (event.code === 'ArrowUp' || event.code === 'ArrowLeft') {
            event.preventDefault();
            const prevIndex = currentVideoIndex - 1;
            if (prevIndex >= 0) {
                selectVideo(prevIndex);
            }
        }
    }
});

// Handle keyboard shortcuts
document.addEventListener('keydown', function(event) {
    // Space atau Enter untuk mark complete
    if ((event.code === 'Space' || event.code === 'Enter') && currentVideoIndex >= 0) {
        const completeBtn = document.getElementById('completeBtn');
        if (!completeBtn.disabled) {
            event.preventDefault();
            markAsComplete();
        }
    }
    
    // Arrow keys untuk navigasi
    if (event.code === 'ArrowDown' || event.code === 'ArrowRight') {
        event.preventDefault();
        const videos = videoData[currentCourse] || [];
        const nextIndex = currentVideoIndex + 1;
        if (nextIndex < videos.length) {
            selectVideo(nextIndex);
        }
    }
    
    if (event.code === 'ArrowUp' || event.code === 'ArrowLeft') {
        event.preventDefault();
        const prevIndex = currentVideoIndex - 1;
        if (prevIndex >= 0) {
            selectVideo(prevIndex);
        }
    }
});

// Auto-save progress setiap 30 detik
setInterval(() => {
    saveProgress();
}, 30000);

// Save progress sebelum halaman ditutup
window.addEventListener('beforeunload', function() {
    saveProgress();
});
    </script>
</body>
</html>